<sw-page class="moorl-parts-list-configurator-detail">
    <template #smart-bar-actions>
        <mt-button @click="$router.push({name: 'moorl.creator.list'})">
            {{ $tc('global.default.cancel') }}
        </mt-button>

        <sw-button-process
                :isLoading="isLoading"
                :processSuccess="processSuccess"
                variant="primary"
                @update:process-success="saveFinish"
                @click="onClickSave">
            {{ $tc('global.default.save') }}
        </sw-button-process>
    </template>

    <template #language-switch>
        <sw-language-switch
                :disabled="item && item.isNew()"
                @on-change="onChangeLanguage"
        />
    </template>

    <template #content>
        <sw-card-view v-if="item">
            <sw-tabs default-item="general">
                <template #default="{ active }">
                    {% block moorl_pl_detail_tabs %}
                        <sw-tabs-item
                                name="general"
                                :activeTab="active"
                        >
                            {{ $tc('moorl-parts-list-configurator.cards.general') }}
                        </sw-tabs-item>

                        <sw-tabs-item
                                name="layout"
                                :activeTab="active"
                                :disabled="item && item.isNew()"
                        >
                            {{ $tc('moorl-parts-list-configurator.cards.layout') }}
                        </sw-tabs-item>

                        <sw-tabs-item
                                name="seo"
                                :activeTab="active"
                                :disabled="item && item.isNew()"
                        >
                            {{ $tc('moorl-parts-list-configurator.cards.seo') }}
                        </sw-tabs-item>

                        <sw-tabs-item
                                name="assignment"
                                :activeTab="active"
                                :disabled="item && item.isNew()"
                        >
                            {{ $tc('moorl-parts-list-configurator.cards.assignment') }}
                        </sw-tabs-item>
                    {% endblock %}
                </template>

                <template #content="{ active }">
                    {% block moorl_pl_detail_content %}
                        <moorl-entity-grid-card
                                v-if="active === 'assignment'"
                                :title="$tc('moorl-parts-list-configurator.cards.filters')"
                                key="moorl_pl_filter"
                                entity="moorl_pl_filter"
                                snippetSrc="moorl-parts-list-configurator"
                                :isLoading="isLoading"
                                :filterColumns="partsListFilterFilterColumns"
                                :criteria="partsListFilterCriteria"
                                :default-item="{ partsListConfiguratorId: item.id }"
                        />

                        <moorl-layout-card
                                v-bind="{ item, cmsPage, isLoading, pageTypes }"
                                v-if="active === 'layout'"
                        />

                        <sw-cms-page-form
                                v-if="active === 'layout' && cmsPage"
                                :page="cmsPage"
                        />

                        <moorl-thing-seo-card v-if="active === 'seo'" v-model:item="item" :hidden="['keywords', 'seoUrl']"/>

                        <sw-card
                                v-if="active === 'general'"
                                :isLoading="isLoading"
                                :title="$tc('moorl-parts-list-configurator.cards.general')"
                        >
                            <sw-text-field
                                    :label="$tc('moorl-parts-list-configurator.properties.calculator')"
                                    v-model:value="item.calculator"
                                    required
                                    validation="required"
                                    :error="itemCalculatorError"
                            />

                            <sw-switch-field
                                    bordered
                                    :label="$tc('moorl-parts-list-configurator.properties.active')"
                                    v-model:value="item.active"
                            />

                            <sw-text-field
                                    :label="$tc('moorl-parts-list-configurator.properties.name')"
                                    v-model:value="item.name"
                                    required
                                    validation="required"
                                    :error="itemNameError"
                            />

                            <sw-language-info :entityDescription="item.name"/>

                            <sw-textarea-field
                                    :label="$tc('moorl-parts-list-configurator.properties.teaser')"
                                    v-model:value="item.teaser"
                            />

                            <sw-text-editor
                                    :label="$tc('moorl-parts-list-configurator.properties.description')"
                                    v-model:value="item.description"
                            />
                        </sw-card>

                        <sw-card
                                v-if="item.id && active === 'general'"
                                :isLoading="isLoading"
                                :title="$tc('moorl-parts-list-configurator.cards.media')"
                        >
                            <moorl-media-gallery
                                    :item="item"
                                    entity="moorl_pl_media"
                                    defaultFolder="moorl_pl"
                                    @media-open="onOpenMediaModal"
                            />
                        </sw-card>

                        <sw-card
                                v-if="active === 'general' && !!customFieldSets && customFieldSets.length > 0"
                                position-identifier="sw-customer-detail-base-custom-field-sets"
                                :title="$tc('sw-settings-custom-field.general.mainMenuItemGeneral')"
                        >
                            <sw-custom-field-set-renderer
                                    :entity="item"
                                    :sets="customFieldSets"
                            />
                        </sw-card>
                    {% endblock %}
                </template>
            </sw-tabs>
        </sw-card-view>
    </template>
</sw-page>
