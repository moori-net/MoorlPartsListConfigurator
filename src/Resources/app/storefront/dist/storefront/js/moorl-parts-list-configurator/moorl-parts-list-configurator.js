(()=>{"use strict";var t={156:t=>{var e=function(t){var e;return!!t&&"object"==typeof t&&"[object RegExp]"!==(e=Object.prototype.toString.call(t))&&"[object Date]"!==e&&t.$$typeof!==r},r="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function i(t,e){return!1!==e.clone&&e.isMergeableObject(t)?a(Array.isArray(t)?[]:{},t,e):t}function n(t,e,r){return t.concat(e).map(function(t){return i(t,r)})}function s(t){return Object.keys(t).concat(Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t).filter(function(e){return Object.propertyIsEnumerable.call(t,e)}):[])}function o(t,e){try{return e in t}catch(t){return!1}}function a(t,r,l){(l=l||{}).arrayMerge=l.arrayMerge||n,l.isMergeableObject=l.isMergeableObject||e,l.cloneUnlessOtherwiseSpecified=i;var c,h,u=Array.isArray(r);return u!==Array.isArray(t)?i(r,l):u?l.arrayMerge(t,r,l):(h={},(c=l).isMergeableObject(t)&&s(t).forEach(function(e){h[e]=i(t[e],c)}),s(r).forEach(function(e){(!o(t,e)||Object.hasOwnProperty.call(t,e)&&Object.propertyIsEnumerable.call(t,e))&&(o(t,e)&&c.isMergeableObject(r[e])?h[e]=(function(t,e){if(!e.customMerge)return a;var r=e.customMerge(t);return"function"==typeof r?r:a})(e,c)(t[e],r[e],c):h[e]=i(r[e],c))}),h)}a.all=function(t,e){if(!Array.isArray(t))throw Error("first argument should be an array");return t.reduce(function(t,r){return a(t,r,e)},{})},t.exports=a}},e={};function r(i){var n=e[i];if(void 0!==n)return n.exports;var s=e[i]={exports:{}};return t[i](s,s.exports,r),s.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var i in e)r.o(e,i)&&!r.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var i=r(156),n=r.n(i);class s{static ucFirst(t){return t.charAt(0).toUpperCase()+t.slice(1)}static lcFirst(t){return t.charAt(0).toLowerCase()+t.slice(1)}static toDashCase(t){return t.replace(/([A-Z])/g,"-$1").replace(/^-/,"").toLowerCase()}static toLowerCamelCase(t,e){let r=s.toUpperCamelCase(t,e);return s.lcFirst(r)}static toUpperCamelCase(t,e){return e?t.split(e).map(t=>s.ucFirst(t.toLowerCase())).join(""):s.ucFirst(t.toLowerCase())}static parsePrimitive(t){try{return/^\d+(.|,)\d+$/.test(t)&&(t=t.replace(",",".")),JSON.parse(t)}catch(e){return t.toString()}}}class o{constructor(t=document){this._el=t,t.$emitter=this,this._listeners=[]}publish(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=new CustomEvent(t,{detail:e,cancelable:r});return this.el.dispatchEvent(i),i}subscribe(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this,n=t.split("."),s=r.scope?e.bind(r.scope):e;if(r.once&&!0===r.once){let e=s;s=function(r){i.unsubscribe(t),e(r)}}return this.el.addEventListener(n[0],s),this.listeners.push({splitEventName:n,opts:r,cb:s}),!0}unsubscribe(t){let e=t.split(".");return this.listeners=this.listeners.reduce((t,r)=>([...r.splitEventName].sort().toString()===e.sort().toString()?this.el.removeEventListener(r.splitEventName[0],r.cb):t.push(r),t),[]),!0}reset(){return this.listeners.forEach(t=>{this.el.removeEventListener(t.splitEventName[0],t.cb)}),this.listeners=[],!0}get el(){return this._el}set el(t){this._el=t}get listeners(){return this._listeners}set listeners(t){this._listeners=t}}class a{constructor(t,e={},r=!1){if(!(t instanceof Node)){console.warn(`There is no valid element given while trying to create a plugin instance for "${r}".`);return}this.el=t,this.$emitter=new o(this.el),this._pluginName=this._getPluginName(r),this.options=this._mergeOptions(e),this._initialized=!1,this._registerInstance(),this._init()}init(){console.warn(`The "init" method for the plugin "${this._pluginName}" is not defined. The plugin will not be initialized.`)}update(){}_init(){this._initialized||(this.init(),this._initialized=!0)}_update(){this._initialized&&this.update()}_mergeOptions(t){let e=[this.constructor.options,this.options,t];return e.push(this._getConfigFromDataAttribute()),e.push(this._getOptionsFromDataAttribute()),n().all(e.filter(t=>t instanceof Object&&!(t instanceof Array)).map(t=>t||{}))}_getConfigFromDataAttribute(){let t={};if("function"!=typeof this.el.getAttribute)return t;let e=s.toDashCase(this._pluginName),r=this.el.getAttribute(`data-${e}-config`);return r?window.PluginConfigManager.get(this._pluginName,r):t}_getOptionsFromDataAttribute(){let t={};if("function"!=typeof this.el.getAttribute)return t;let e=s.toDashCase(this._pluginName),r=this.el.getAttribute(`data-${e}-options`);if(r)try{return JSON.parse(r)}catch(t){console.error(`The data attribute "data-${e}-options" could not be parsed to json: ${t.message}`)}return t}_registerInstance(){window.PluginManager.getPluginInstancesFromElement(this.el).set(this._pluginName,this),window.PluginManager.getPlugin(this._pluginName,!1).get("instances").push(this)}_getPluginName(t){return t||(t=this.constructor.name),t}}class l{constructor(){this._request=null,this._errorHandlingInternal=!1}get(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"application/json",i=this._createPreparedRequest("GET",t,r);return this._sendRequest(i,null,e)}post(t,e,r){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"application/json";i=this._getContentType(e,i);let n=this._createPreparedRequest("POST",t,i);return this._sendRequest(n,e,r)}delete(t,e,r){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"application/json";i=this._getContentType(e,i);let n=this._createPreparedRequest("DELETE",t,i);return this._sendRequest(n,e,r)}patch(t,e,r){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"application/json";i=this._getContentType(e,i);let n=this._createPreparedRequest("PATCH",t,i);return this._sendRequest(n,e,r)}abort(){if(this._request)return this._request.abort()}setErrorHandlingInternal(t){this._errorHandlingInternal=t}_registerOnLoaded(t,e){e&&(!0===this._errorHandlingInternal?(t.addEventListener("load",()=>{e(t.responseText,t)}),t.addEventListener("abort",()=>{console.warn(`the request to ${t.responseURL} was aborted`)}),t.addEventListener("error",()=>{console.warn(`the request to ${t.responseURL} failed with status ${t.status}`)}),t.addEventListener("timeout",()=>{console.warn(`the request to ${t.responseURL} timed out`)})):t.addEventListener("loadend",()=>{e(t.responseText,t)}))}_sendRequest(t,e,r){return this._registerOnLoaded(t,r),t.send(e),t}_getContentType(t,e){return t instanceof FormData&&(e=!1),e}_createPreparedRequest(t,e,r){return this._request=new XMLHttpRequest,this._request.open(t,e),this._request.setRequestHeader("X-Requested-With","XMLHttpRequest"),r&&this._request.setRequestHeader("Content-type",r),this._request}}function c(){return(c=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)({}).hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t}).apply(null,arguments)}function h(t){return"/"===t.charAt(0)}function u(t,e){for(var r=e,i=r+1,n=t.length;i<n;r+=1,i+=1)t[r]=t[i];t.pop()}let p=function(t,e){void 0===e&&(e="");var r,i=t&&t.split("/")||[],n=e&&e.split("/")||[],s=t&&h(t),o=e&&h(e),a=s||o;if(t&&h(t)?n=i:i.length&&(n.pop(),n=n.concat(i)),!n.length)return"/";if(n.length){var l=n[n.length-1];r="."===l||".."===l||""===l}else r=!1;for(var c=0,p=n.length;p>=0;p--){var d=n[p];"."===d?u(n,p):".."===d?(u(n,p),c++):c&&(u(n,p),c--)}if(!a)for(;c--;c)n.unshift("..");!a||""===n[0]||n[0]&&h(n[0])||n.unshift("");var f=n.join("/");return r&&"/"!==f.substr(-1)&&(f+="/"),f};function d(t,e,r,i){var n,s,o,a,l,h;"string"==typeof t?(o="",a="",-1!==(l=(s=t||"/").indexOf("#"))&&(a=s.substr(l),s=s.substr(0,l)),-1!==(h=s.indexOf("?"))&&(o=s.substr(h),s=s.substr(0,h)),(n={pathname:s,search:"?"===o?"":o,hash:"#"===a?"":a}).state=e):(void 0===(n=c({},t)).pathname&&(n.pathname=""),n.search?"?"!==n.search.charAt(0)&&(n.search="?"+n.search):n.search="",n.hash?"#"!==n.hash.charAt(0)&&(n.hash="#"+n.hash):n.hash="",void 0!==e&&void 0===n.state&&(n.state=e));try{n.pathname=decodeURI(n.pathname)}catch(t){if(t instanceof URIError)throw URIError('Pathname "'+n.pathname+'" could not be decoded. This is likely caused by an invalid percent-encoding.');throw t}return r&&(n.key=r),i?n.pathname?"/"!==n.pathname.charAt(0)&&(n.pathname=p(n.pathname,i.pathname)):n.pathname=i.pathname:n.pathname||(n.pathname="/"),n}var f=!!("undefined"!=typeof window&&window.document&&window.document.createElement);function g(t,e){e(window.confirm(t))}var m="popstate",_="hashchange";function y(){try{return window.history.state||{}}catch(t){return{}}}let v=Object.freeze(new class{constructor(){this._history=function(t){void 0===t&&(t={}),f||function(t,e){if(!t)throw Error("Invariant failed")}(!1);var e,r,i,n,s,o=window.history,a=(-1===(s=window.navigator.userAgent).indexOf("Android 2.")&&-1===s.indexOf("Android 4.0")||-1===s.indexOf("Mobile Safari")||-1!==s.indexOf("Chrome")||-1!==s.indexOf("Windows Phone"))&&window.history&&"pushState"in window.history,l=-1!==window.navigator.userAgent.indexOf("Trident"),h=t,u=h.forceRefresh,p=void 0!==u&&u,v=h.getUserConfirmation,w=void 0===v?g:v,b=h.keyLength,E=void 0===b?6:b,L=t.basename?"/"===(r="/"===(e=t.basename).charAt(0)?e:"/"+e).charAt(r.length-1)?r.slice(0,-1):r:"";function O(t){var e,r,i=t||{},n=i.key,s=i.state,o=window.location,a=o.pathname+o.search+o.hash;return L&&(e=a,r=L,a=0===e.toLowerCase().indexOf(r.toLowerCase())&&-1!=="/?#".indexOf(e.charAt(r.length))?e.substr(r.length):e),d(a,s,n)}function P(){return Math.random().toString(36).substr(2,E)}var S=(i=null,n=[],{setPrompt:function(t){return i=t,function(){i===t&&(i=null)}},confirmTransitionTo:function(t,e,r,n){if(null!=i){var s="function"==typeof i?i(t,e):i;"string"==typeof s?"function"==typeof r?r(s,n):n(!0):n(!1!==s)}else n(!0)},appendListener:function(t){var e=!0;function r(){e&&t.apply(void 0,arguments)}return n.push(r),function(){e=!1,n=n.filter(function(t){return t!==r})}},notifyListeners:function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];n.forEach(function(t){return t.apply(void 0,e)})}});function A(t){c($,t),$.length=o.length,S.notifyListeners($.location,$.action)}function C(t){(void 0!==t.state||-1!==navigator.userAgent.indexOf("CriOS"))&&R(O(t.state))}function j(){R(O(y()))}var q=!1;function R(t){q?(q=!1,A()):S.confirmTransitionTo(t,"POP",w,function(e){var r,i,n,s;e?A({action:"POP",location:t}):(r=$.location,-1===(i=T.indexOf(r.key))&&(i=0),-1===(n=T.indexOf(t.key))&&(n=0),(s=i-n)&&(q=!0,M(s)))})}var x=O(y()),T=[x.key];function k(t){var e,r,i,n;return L+(e=t.pathname,r=t.search,i=t.hash,n=e||"/",r&&"?"!==r&&(n+="?"===r.charAt(0)?r:"?"+r),i&&"#"!==i&&(n+="#"===i.charAt(0)?i:"#"+i),n)}function M(t){o.go(t)}var U=0;function F(t){1===(U+=t)&&1===t?(window.addEventListener(m,C),l&&window.addEventListener(_,j)):0===U&&(window.removeEventListener(m,C),l&&window.removeEventListener(_,j))}var H=!1,$={length:o.length,action:"POP",location:x,createHref:k,push:function(t,e){var r="PUSH",i=d(t,e,P(),$.location);S.confirmTransitionTo(i,r,w,function(t){if(t){var e=k(i),n=i.key,s=i.state;if(a){if(o.pushState({key:n,state:s},null,e),p)window.location.href=e;else{var l=T.indexOf($.location.key),c=T.slice(0,l+1);c.push(i.key),T=c,A({action:r,location:i})}}else window.location.href=e}})},replace:function(t,e){var r="REPLACE",i=d(t,e,P(),$.location);S.confirmTransitionTo(i,r,w,function(t){if(t){var e=k(i),n=i.key,s=i.state;if(a){if(o.replaceState({key:n,state:s},null,e),p)window.location.replace(e);else{var l=T.indexOf($.location.key);-1!==l&&(T[l]=i.key),A({action:r,location:i})}}else window.location.replace(e)}})},go:M,goBack:function(){M(-1)},goForward:function(){M(1)},block:function(t){void 0===t&&(t=!1);var e=S.setPrompt(t);return H||(F(1),H=!0),function(){return H&&(H=!1,F(-1)),e()}},listen:function(t){var e=S.appendListener(t);return F(1),function(){F(-1),e()}}};return $}()}getLocation(){return this._history.location}listen(t){return this._history.listen(t)}unlisten(t){t()}push(t,e,r){this._history.push({pathname:t,search:e,state:r})}replace(t,e,r){this._history.replace({pathname:t,search:e,state:r})}pushParams(t,e){let r=this.getLocation().pathname,i=Object.fromEntries(new URLSearchParams(location.search).entries()),s=new URLSearchParams(n()(i,t)).toString();this.push(r,s,e)}replaceParams(t,e){let r=this.getLocation().pathname,i=Object.fromEntries(new URLSearchParams(location.search).entries()),s=new URLSearchParams(n()(i,t)).toString();this.replace(r,s,e)}getSearch(){return this._history.location.search}});class w{static getLocation(){return v.getLocation()}static listen(t){v.listen(t)}static unlisten(t){v.unlisten(t)}static push(t,e,r){v.push(t,e,r)}static replace(t,e){v.replace(t,e)}static pushParams(t,e){v.pushParams(t,e)}static replaceParams(t,e){v.replaceParams(t,e)}static getSearch(){return v.getSearch()}}class b extends a{static #t=this.options={type:"calculator",url:null,optionCount:0,loaderClass:"loader"};init(){this._client=new l(window.accessKey,window.contextToken),this._filters={options:[]},this._timeout=null,this._step=0,this._partsListEl=document.getElementById("partsList"),this._accessoryList=document.getElementById("accessoryList"),this._formEl=this.el.querySelector("form"),this._loadButton=this.el.querySelector(".js-load-button"),this._formEl.querySelectorAll(".js-group").forEach(t=>{this.options.optionCount++;let e=t.querySelector("[data-step]");e&&(e.innerText=this.options.optionCount)}),this._setFilterState(),this._registerEvents(),this._refresh("options")}_loaderElement(){let t=document.createElement("div");t.classList.add("d-flex","justify-content-center","align-items-center","p-5");let e=document.createElement("span");return e.classList.add(this.options.loaderClass),t.appendChild(e),t}_setFilterState(){let t=Object.fromEntries(new URLSearchParams(window.location.search).entries());Object.keys(t).length>0&&this._setValuesFromUrl(t)}_registerEvents(){this._formEl.querySelectorAll("input[type=radio]").forEach(t=>{["keyup","change","force"].forEach(e=>{t.addEventListener(e,()=>{this._refresh("options")},!1)})}),this._loadButton.addEventListener("click",()=>{this._loadHistory(),this._partsListEl.style.display="",this._loadButton.disabled=!0,"calculator"===this.options.type?this._loadProxyCart():this._loadPartsList()})}_registerListEvents(t){t.querySelectorAll("input[type=number]").forEach(t=>{["change"].forEach(e=>{t.addEventListener(e,()=>{this._refresh("list")},!1)})})}_refresh(t){this._timeout&&(clearTimeout(this._timeout),this._timeout=null),this._loadHistory(),this._partsListEl.style.display="none",this._loadButton.disabled=!1,this._timeout=setTimeout(()=>{"options"===t&&(this._loadAccessoryList(),this._formEl.querySelectorAll(".js-group").forEach(t=>{this._loadLogicalConfigurator(t)}),this._timeout=null)},1e3)}_loadList(t,e){if(this._filters.options.length<this.options.optionCount)return;this._showHiddenElements();let r=t.querySelector("[data-content]")??t;r.replaceChildren(this._loaderElement());let i=new URLSearchParams(this._mapFilters(this._filters)).toString();this._client.get(this.options.url+"/"+e+"?"+i,t=>{r.innerHTML=t,window.PluginManager.initializePlugins(),this._setFilterState(),this._registerListEvents(r)})}_showHiddenElements(){this.el.querySelectorAll("[data-hide-on-load]").forEach(t=>{t.style.display=""})}_loadPartsList(){this._loadList(this._partsListEl,"parts-list")}_loadProxyCart(){this._loadList(this._partsListEl,"proxy-cart")}_loadAccessoryList(){this._loadList(this._accessoryList,"accessory-list")}_loadLogicalConfigurator(t){t.dataset.logical&&(this._filters.group=t.dataset.technicalName,this._loadList(t.querySelector(".js-logical-configurator"),"logical-configurator"))}_loadHistory(){this._filters=Object.assign(Object.fromEntries(new URLSearchParams(window.location.search).entries()),{options:[]}),this._formEl.querySelectorAll("input[type=radio]").forEach(t=>{t.checked&&this._filters.options.push(t.value)}),this._formEl.querySelectorAll("input[type=number]").forEach(t=>{this._filters[t.name]=t.value});let t=new URLSearchParams(this._mapFilters(this._filters)).toString();this._updateHistory(t)}_setValuesFromUrl(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(let[e,r]of Object.entries(t))if("options"===e)(r?r.split("|"):[]).forEach(t=>{let e=this.el.querySelector('input[type=radio][value="'+t+'"]');e&&(e.checked=!0)});else{let t=this.el.querySelector('input[type=number][name="'+e+'"]');t&&(t.value=r)}}_updateHistory(t){w.push(w.getLocation().pathname,t,{})}_mapFilters(t){let e={};return Object.keys(t).forEach(r=>{let i=t[r];Array.isArray(i)&&(i=i.join("|")),`${i}`.length&&(e[r]=i)}),e}}window.PluginManager.register("MoorlPartsListConfigurator",b,"[data-moorl-parts-list-configurator]")})();