{"version":3,"file":"moorl-parts-list-configurator-BGbgweyf.js","sources":["../../../app/administration/src/component/calculator/index.html.twig","../../../app/administration/src/component/calculator/index.js","../../../app/administration/src/extension/sw-property-option-detail/sw-property-option-detail.html.twig","../../../app/administration/src/extension/sw-property-option-detail/index.js","../../../app/administration/src/module/sw-cms/elements/parts-list-configurator/config/index.html.twig","../../../app/administration/src/module/sw-cms/elements/parts-list-configurator/config/index.js","../../../app/administration/src/module/sw-cms/elements/parts-list-configurator/component/index.html.twig","../../../app/administration/src/module/sw-cms/elements/parts-list-configurator/component/index.js","../../../app/administration/src/module/sw-cms/elements/parts-list-configurator/index.js","../../../app/administration/src/main.js"],"sourcesContent":["<div class=\"moorl-parts-list-calculator\">\n    <template v-if=\"partsListConfigurator.type === 'calculator' && calculatorOptions.length > 0\">\n        <moorl-select-field\n                v-model:value=\"partsListConfigurator.calculator\"\n                @update:value=\"refresh\"\n                :label=\"$tc('moorl-foundation.field.calculator')\"\n                :customSet=\"calculatorOptions\"\n        />\n\n        <sw-data-grid\n                v-if=\"mapping.length > 0\"\n                :data-source=\"mapping\"\n                :columns=\"gridColumns\"\n                :show-selection=\"false\"\n                :plain-appearance=\"true\"\n                :show-actions=\"false\"\n        >\n            <template #column-value=\"{ item, itemIndex }\">\n                <sw-entity-single-select\n                        v-model:value=\"partsListConfigurator.mapping[item.name]\"\n                        :entity=\"item.entity\"\n                />\n            </template>\n        </sw-data-grid>\n    </template>\n</div>\n","import template from './index.html.twig';\n\nShopware.Component.register('moorl-parts-list-calculator', {\n    template,\n\n    inject: [\n        'foundationApiService',\n        'repositoryFactory'\n    ],\n\n    props: {\n        partsListConfigurator: {\n            type: Object,\n            required: true\n        },\n    },\n\n    data() {\n        return {\n            calculators: [],\n            mapping: [],\n        };\n    },\n\n    computed: {\n        calculatorOptions() {\n            return Object.keys(this.calculators);\n        },\n\n        gridColumns() {\n            return  [\n                {\n                    label: this.$tc('moorl-foundation.field.entity'),\n                    property: 'entity',\n                    dataIndex: 'entity',\n                    primary: true,\n                },\n                {\n                    label: this.$tc('moorl-foundation.field.name'),\n                    property: 'name',\n                    dataIndex: 'name',\n                    primary: true,\n                },\n                {\n                    label: this.$tc('moorl-foundation.field.flags'),\n                    property: 'flags',\n                    dataIndex: 'flags',\n                    primary: true,\n                },\n                {\n                    label: this.$tc('moorl-foundation.field.value'),\n                    property: 'value',\n                    dataIndex: 'value',\n                    primary: true,\n                    width: '320px',\n                }\n            ];\n        },\n    },\n\n    created() {\n        this.createdComponent();\n    },\n\n    methods: {\n        createdComponent() {\n            this.foundationApiService\n                .get('/moorl-pl/get-parts-list-calculators')\n                .then((response) => {\n                    this.calculators = response;\n\n                    this.refresh();\n                });\n        },\n\n        refresh() {\n            this.initMapping();\n        },\n\n        initMapping() {\n            this.partsListConfigurator.mapping ??= {};\n            this.mapping = [];\n\n            if (!this.partsListConfigurator.calculator || this.calculators.length === 0) {\n                return;\n            }\n\n            for (const [entity, mapping] of Object.entries(this.calculators[this.partsListConfigurator.calculator])) {\n                for (const [name, flags] of Object.entries(mapping)) {\n                    this.partsListConfigurator.mapping[name] ??= null;\n                    this.mapping.push({\n                        entity,\n                        name,\n                        flags: flags.join(',')\n                    });\n                }\n            }\n        }\n    }\n});\n","{% block sw_property_option_detail_media %}\n    {% parent %}\n\n    <div class=\"sw-field\"></div>\n\n    <sw-custom-field-set-renderer\n            :entity=\"currentOption\"\n            :sets=\"customFieldSets\"\n    />\n{% endblock %}\n","import template from './sw-property-option-detail.html.twig';\n\nShopware.Component.override('sw-property-option-detail', {\n    template,\n\n    inject: [\n        'customFieldDataProviderService',\n    ],\n\n    data() {\n        return {\n            customFieldSets: null\n        };\n    },\n\n    created() {\n        this.loadCustomFieldSets();\n\n    },\n\n    methods: {\n        loadCustomFieldSets() {\n            this.customFieldDataProviderService.getCustomFieldSets('property_group_option').then((sets) => {\n                this.customFieldSets = sets;\n            });\n        },\n    }\n});\n","<div class=\"sw-cms-el-config-moorl-parts-list-configurator\">\n    <sw-cms-mapping-field v-model:config=\"element.config.partsListConfigurator\" value-types=\"string\">\n        <sw-entity-single-select\n                :label=\"$tc('sw-cms.elements.moorl-parts-list-configurator.name')\"\n                v-model:value=\"element.config.partsListConfigurator.value\"\n\n                @update:value=\"onChangePartsListConfigurator\"\n                entity=\"moorl_pl\"\n        />\n    </sw-cms-mapping-field>\n</div>\n","const {Criteria} = Shopware.Data;\n\nimport template from './index.html.twig';\n\nShopware.Component.register('sw-cms-el-config-moorl-parts-list-configurator', {\n    template,\n\n    mixins: [\n        Shopware.Mixin.getByName('cms-element')\n    ],\n\n    inject: ['repositoryFactory'],\n\n    computed: {\n        formRepository() {\n            return this.repositoryFactory.create('moorl_pl');\n        },\n    },\n\n    created() {\n        this.createdComponent();\n    },\n\n    methods: {\n        createdComponent() {\n            this.initElementConfig('moorl-parts-list-configurator');\n            this.initElementData('moorl-parts-list-configurator');\n        },\n\n        onChangePartsListConfigurator(formId) {\n            if (!formId) {\n                this.element.config.partsListConfigurator.value = null;\n                this.element.data.partsListConfigurator = null;\n            } else {\n                const criteria = new Criteria();\n\n                this.formRepository.get(formId, Shopware.Context.api, criteria).then((form) => {\n                    this.element.config.partsListConfigurator.value = formId;\n                    this.element.data.partsListConfigurator = form;\n                });\n            }\n\n            this.$emit('element-update', this.element);\n        },\n    }\n});\n","<div class=\"sw-cms-el-moorl-default\">\n    <div>\n        {{ $tc('sw-cms.elements.moorl-parts-list-configurator.name') }}\n    </div>\n\n    <template v-if=\"partsListConfigurator\">\n        <div class=\"small\">\n            {{ partsListConfigurator.translated.name }}\n        </div>\n\n        <router-link\n                class=\"mt-button\"\n                target=\"_blank\"\n                rel=\"noopener\"\n                :to=\"{ name: 'moorl.parts.list.configurator.detail', params: { id: partsListConfigurator.id } }\"\n        >\n            {{ $tc('global.default.edit') }}\n        </router-link>\n    </template>\n\n    <template v-else>\n        <router-link\n                class=\"mt-button\"\n                target=\"_blank\"\n                rel=\"noopener\"\n                :to=\"{ name: 'moorl.parts.list.configurator.list' }\"\n        >\n            {{ $tc('global.default.add') }}\n        </router-link>\n    </template>\n</div>\n","import template from './index.html.twig';\n\nShopware.Component.register('sw-cms-el-moorl-parts-list-configurator', {\n    template,\n\n    mixins: [\n        Shopware.Mixin.getByName('cms-element')\n    ],\n\n    computed: {\n        partsListConfigurator() {\n            return this.element.data?.partsListConfigurator;\n        },\n    },\n\n    created() {\n        this.createdComponent();\n    },\n\n    methods: {\n        createdComponent() {\n            this.initElementConfig('moorl-parts-list-configurator');\n            this.initElementData('moorl-parts-list-configurator');\n        }\n    }\n});\n","import './config';\nimport './component';\n\nShopware.Application.getContainer('service').cmsService.registerCmsElement({\n    plugin: 'MoorlPartsListConfigurator',\n    icon: 'regular-3d',\n    name: 'moorl-parts-list-configurator',\n    label: 'sw-cms.elements.moorl-parts-list-configurator.name',\n    component: 'sw-cms-el-moorl-parts-list-configurator',\n    configComponent: 'sw-cms-el-config-moorl-parts-list-configurator',\n    previewComponent: true,\n    defaultConfig: {\n        partsListConfigurator: {\n            source: 'static',\n            value: null,\n            entity: {\n                name: 'moorl_pl'\n            }\n        }\n    }\n});\n","function onMoorlFoundationReady(callback) {\n    if (window.MoorlFoundation) {\n        callback();\n    } else {\n        window.addEventListener('MoorlFoundationReady', callback, { once: true });\n    }\n}\n\nonMoorlFoundationReady(() => {\n    MoorlFoundation.ModuleHelper.registerModule({\n        entity: 'moorl_pl',\n        name: 'moorl-parts-list-configurator',\n        navigationParent: 'sw-catalogue',\n        pageType: 'parts_list_configurator_detail',\n        properties: [\n            {name: 'active', visibility: 100},\n            {name: 'name', visibility: 200},\n        ],\n        pluginName: 'MoorlPartsListConfigurator',\n        demoName: 'standard',\n        entityMapping: {\n            filters: {\n                tab: 'relations',\n                componentName: 'moorl-entity-grid-card-v2'\n            },\n            type: {\n                componentName: 'moorl-select-field',\n                attributes: {\n                    customSet: [\n                        {value: 'calculator', label: 'moorl-parts-list-configurator.type.calculator'},\n                        {value: 'filter', label: 'moorl-parts-list-configurator.type.filter'},\n                    ]\n                }\n            },\n            calculator: {\n                conditions: [{property: 'type', value: 'calculator', operator: 'eq'}],\n                cols: 12,\n                componentName: 'moorl-parts-list-calculator',\n                attributes: {\n                    partsListConfigurator: ({item}) => item,\n                },\n            }\n        },\n        cmsElements: [\n            {\n                name: 'parts-list-configurator-listing',\n                parent: 'listing',\n                icon: 'regular-view-grid',\n                cmsElementEntity: {\n                    associations: ['cover.media'],\n                    propertyMapping: {\n                        media: 'cover.media',\n                        name: ['translated.name', 'name'],\n                        description: ['translated.teaser', 'teaser'],\n                    },\n                }\n            }\n        ]\n    });\n\n    MoorlFoundation.ModuleHelper.registerModule({\n        entity: 'moorl_pl_filter',\n        name: 'moorl-parts-list-filter',\n        properties: [\n            {name: 'position', visibility: 200},\n            {name: 'fixed', visibility: 50},\n            {name: 'logical', visibility: 100},\n            {name: 'technicalName', visibility: 100},\n            {name: 'partsListConfigurator.name', visibility: 100},\n            {name: 'options', visibility: 0},\n        ],\n        entityMapping: {\n            options: {\n                tab: 'relations',\n                card: 'relations',\n            }\n        },\n    });\n});\n\nimport './component';\nimport './extension';\nimport './module';\n"],"names":["template$3","template","response","_a","_b","entity","mapping","name","flags","template$2","sets","template$1","Criteria","formId","criteria","form","onMoorlFoundationReady","callback","item"],"mappings":"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"}